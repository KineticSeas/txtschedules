import { Component, Input, Output, EventEmitter } from '@angular/core';
import { CommonModule } from '@angular/common';
import { MatCommonModule } from '@angular/material/core';
import * as i0 from "@angular/core";
import * as i1 from "../data.service";
import * as i2 from "@angular/common";
export class SqlFormComponent {
    constructor(_dataService) {
        // part of an edit table or container.
        this._dataService = _dataService;
        this.last_id = '';
        this.containerParameters = { id: '', id2: '', id3: '' };
        this.id = '0';
        this.id2 = '0';
        this.id3 = '0';
        this.id2_col = '';
        this.id3_col = '';
        this.default_col = '';
        this.default_col2 = '';
        this.default_col3 = '';
        this.default_value = '';
        this.default_value2 = '';
        this.default_value3 = '';
        this.table = "dual";
        this.embedded = "Y";
        this.card = "Y";
        this.closable = "N";
        this.open = "Y";
        this.class = "";
        this.style = "";
        this.title = "";
        this.bs_row = 'N';
        this.bs_col = '';
        this.handler = 'default';
        this.reload = 'N';
        this.parameters = { page: '', id: '', id2: '', id3: '' };
        this.change = new EventEmitter();
        this.saved = new EventEmitter();
        this.counter = 0;
        this.showErrorAlert = 'N';
        this.errorMessage = 'Post Failed';
        this.showSuccessAlert = 'N';
        if (this.embedded == 'Y') {
            console.log('form constructor');
            this.myContainerObs = this._dataService.containerSubject.subscribe(d => {
                console.log('container parameters');
                console.log(d);
                this.containerParameters = d;
                if (this.containerParameters.id != this.last_id) {
                    this.last_id = this.containerParameters.id;
                    this.id = this.containerParameters.id;
                    if (this.containerParameters.id2 !== undefined) {
                        this.id2 = this.containerParameters.id2;
                    }
                    if (this.containerParameters.id3 !== undefined) {
                        this.id3 = this.containerParameters.id3;
                    }
                    if (this.containerParameters.default_col !== undefined) {
                        this.default_col = this.containerParameters.default_col;
                    }
                    if (this.containerParameters.default_col2 !== undefined) {
                        this.default_col = this.containerParameters.default_col2;
                    }
                    if (this.containerParameters.default_col3 !== undefined) {
                        this.default_col = this.containerParameters.default_col3;
                    }
                    this.getFormData();
                }
            });
        }
        else {
        }
        this.myDataObs = this._dataService.dataSubject.subscribe(d => {
            console.log('data subject');
            this.data = d;
            if (this.data.id != this.last_id) {
                this.last_id = this.data.id;
                this.id = this.data.id;
            }
            if (this.data.submit === 'Y') {
                this.postSQL();
            }
            if (this.data.submit === 'D') {
                this.postDelete();
            }
        });
    }
    ngOnInit() {
    }
    getFormData() {
        this.parameters.id = this.id;
        this.parameters.id2 = this.id2;
        this.parameters.id3 = this.id3;
        this.parameters.default_col = this.default_col;
        this.parameters.default_col2 = this.default_col2;
        this.parameters.default_col3 = this.default_col3;
        if (this.table != 'dual') {
            this._dataService.getForm(this.table, this.parameters).subscribe((data) => {
                this.data = data;
                //          if (this.default_col!='') { this.data[this.default_col]=this.default_value }
                //          if (this.default_col2!='') { this.data[this.default_col2]=this.default_value2 }        
                //          if (this.default_col3!='') { this.data[this.default_col3]=this.default_value3 }
                this._dataService.pushNotification(this.data);
            });
        }
    }
    ngAfterViewInit() {
        console.log('AVI geting form');
        if (this.embedded !== 'Y') {
            this.getFormData();
        }
    }
    postSQL() {
        this._dataService.postSQL(this.data).subscribe((data) => {
            if (data.error_code == "0") {
                this.showSuccessAlert = 'Y';
                this.showErrorAlert = 'N';
                this.errorMessage = 'Record Saved';
            }
            else {
                this.showSuccessAlert = 'N';
                this.showErrorAlert = 'Y';
                this.errorMessage = data.error_message;
                this.errorMessage = 'Record Saved';
            }
            if (this.reload == 'N') {
                setTimeout(() => {
                    this.showErrorAlert = 'N';
                    this.showSuccessAlert = 'N';
                    this.data.refresh = 'Y';
                    this.data.submit = 'N';
                    this._dataService.pushNotification(data);
                }, 1000);
            }
            else {
                setTimeout(() => {
                    this.showErrorAlert = 'N';
                    this.showSuccessAlert = 'N';
                    this.data.refresh = 'Y';
                    this.data.submit = 'N';
                    this._dataService.pushNotification(data);
                    location.reload();
                }, 500);
            }
        });
    }
    postDelete() {
        this._dataService.postDelete(this.data).subscribe((data) => {
            if (data.error_code == "0") {
                this.showSuccessAlert = 'Y';
                this.showErrorAlert = 'N';
                this.errorMessage = 'Record Saved';
            }
            else {
                this.showSuccessAlert = 'N';
                this.showErrorAlert = 'Y';
                this.errorMessage = data.error_message;
                this.errorMessage = 'Record Saved';
            }
            setTimeout(() => {
                this.showErrorAlert = 'N';
                this.showSuccessAlert = 'N';
                this.data.refresh = 'Y';
                this.data.submit = 'N';
                this._dataService.pushNotification(data);
            }, 1000);
        });
    }
    ngDoCheck() {
    }
    ngOnChanges(changes) {
    }
    ngOnDestroy() {
        //    this.myContainerObs.unsubscribe();
        //    this.myDataObs.unsubscribe();
    }
}
SqlFormComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.3", ngImport: i0, type: SqlFormComponent, deps: [{ token: i1.SQLDataService }], target: i0.ɵɵFactoryTarget.Component });
SqlFormComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.3", type: SqlFormComponent, isStandalone: true, selector: "sql-form", inputs: { data: "data", id: "id", id2: "id2", id3: "id3", id2_col: "id2_col", id3_col: "id3_col", default_col: "default_col", default_col2: "default_col2", default_col3: "default_col3", default_value: "default_value", default_value2: "default_value2", default_value3: "default_value3", table: "table", embedded: "embedded", card: "card", closable: "closable", open: "open", class: "class", style: "style", title: "title", bs_row: "bs_row", bs_col: "bs_col", handler: "handler", reload: "reload" }, outputs: { change: "change", saved: "saved" }, usesOnChanges: true, ngImport: i0, template: "<div *ngIf=\"card=='N'\">\n    <div *ngIf=\"bs_row=='Y'\" class=\"row\">\n        <div [class]=\"bs_col\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col!=''\">\n        <div [class]=\"bs_col\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col==''\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n    </div>\n</div>\n\n<div *ngIf=\"card=='Y'\">\n    <div *ngIf=\"bs_row=='Y'\" class=\"row\">\n        <div [class]=\"bs_col\">\n            <div class=\"card\">\n                <div class=\"card-header\" style=\"margin-top: 0px;\">\n                    <h2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col!=''\">\n        <div [class]=\"bs_col\">\n            <div class=\"card\">\n                <div class=\"card-header p-2\">\n                    <h2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n        </div>\n    </div>    \n    <div *ngIf=\"bs_row!='Y'&&bs_col==''\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h2 p-2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n    </div>    \n</div>\n\n<ng-template #contentTmpl>\n    <div *ngIf=\"showSuccessAlert=='Y'\" class=\"alert alert-success\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n      <div *ngIf=\"showErrorAlert=='Y'\" class=\"alert alert-danger\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n    <ng-content></ng-content>\n    <div *ngIf=\"showSuccessAlert=='Y'\" class=\"alert alert-success\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n      <div *ngIf=\"showErrorAlert=='Y'\" class=\"alert alert-danger\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n</ng-template>", styles: [""], dependencies: [{ kind: "ngmodule", type: CommonModule }, { kind: "directive", type: i2.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "ngmodule", type: MatCommonModule }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.3", ngImport: i0, type: SqlFormComponent, decorators: [{
            type: Component,
            args: [{ selector: 'sql-form', standalone: true, imports: [CommonModule, MatCommonModule], template: "<div *ngIf=\"card=='N'\">\n    <div *ngIf=\"bs_row=='Y'\" class=\"row\">\n        <div [class]=\"bs_col\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col!=''\">\n        <div [class]=\"bs_col\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col==''\">\n            <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n    </div>\n</div>\n\n<div *ngIf=\"card=='Y'\">\n    <div *ngIf=\"bs_row=='Y'\" class=\"row\">\n        <div [class]=\"bs_col\">\n            <div class=\"card\">\n                <div class=\"card-header\" style=\"margin-top: 0px;\">\n                    <h2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div *ngIf=\"bs_row!='Y'&&bs_col!=''\">\n        <div [class]=\"bs_col\">\n            <div class=\"card\">\n                <div class=\"card-header p-2\">\n                    <h2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n        </div>\n    </div>    \n    <div *ngIf=\"bs_row!='Y'&&bs_col==''\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h2 p-2>{{ title }}</h2>\n                </div>\n                <div class=\"card-body\">\n                    <ng-container *ngTemplateOutlet=\"contentTmpl\"></ng-container>\n                </div>\n            </div>\n    </div>    \n</div>\n\n<ng-template #contentTmpl>\n    <div *ngIf=\"showSuccessAlert=='Y'\" class=\"alert alert-success\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n      <div *ngIf=\"showErrorAlert=='Y'\" class=\"alert alert-danger\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n    <ng-content></ng-content>\n    <div *ngIf=\"showSuccessAlert=='Y'\" class=\"alert alert-success\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n      <div *ngIf=\"showErrorAlert=='Y'\" class=\"alert alert-danger\" role=\"alert\">\n        {{ this.errorMessage }}\n      </div>\n</ng-template>" }]
        }], ctorParameters: function () { return [{ type: i1.SQLDataService }]; }, propDecorators: { data: [{
                type: Input
            }], id: [{
                type: Input
            }], id2: [{
                type: Input
            }], id3: [{
                type: Input
            }], id2_col: [{
                type: Input
            }], id3_col: [{
                type: Input
            }], default_col: [{
                type: Input
            }], default_col2: [{
                type: Input
            }], default_col3: [{
                type: Input
            }], default_value: [{
                type: Input
            }], default_value2: [{
                type: Input
            }], default_value3: [{
                type: Input
            }], table: [{
                type: Input
            }], embedded: [{
                type: Input
            }], card: [{
                type: Input
            }], closable: [{
                type: Input
            }], open: [{
                type: Input
            }], class: [{
                type: Input
            }], style: [{
                type: Input
            }], title: [{
                type: Input
            }], bs_row: [{
                type: Input
            }], bs_col: [{
                type: Input
            }], handler: [{
                type: Input
            }], reload: [{
                type: Input
            }], change: [{
                type: Output
            }], saved: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3FsLWZvcm0uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvc3FsLWNvbXBvbmVudHMvc3JjL2xpYi9zcWwtZm9ybS9zcWwtZm9ybS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zcWwtY29tcG9uZW50cy9zcmMvbGliL3NxbC1mb3JtL3NxbC1mb3JtLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQXNGLE1BQU0sZUFBZSxDQUFDO0FBQ25LLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUUvQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7Ozs7QUFVekQsTUFBTSxPQUFPLGdCQUFnQjtJQTJDM0IsWUFBb0IsWUFBNEI7UUFDOUMsc0NBQXNDO1FBRHBCLGlCQUFZLEdBQVosWUFBWSxDQUFnQjtRQXpDaEQsWUFBTyxHQUFRLEVBQUUsQ0FBQztRQUdsQix3QkFBbUIsR0FBUSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFJL0MsT0FBRSxHQUFRLEdBQUcsQ0FBQztRQUNkLFFBQUcsR0FBUSxHQUFHLENBQUM7UUFDZixRQUFHLEdBQVEsR0FBRyxDQUFDO1FBQ2YsWUFBTyxHQUFRLEVBQUUsQ0FBQztRQUNsQixZQUFPLEdBQVEsRUFBRSxDQUFDO1FBQ2xCLGdCQUFXLEdBQVEsRUFBRSxDQUFDO1FBQ3RCLGlCQUFZLEdBQVEsRUFBRSxDQUFDO1FBQ3ZCLGlCQUFZLEdBQVEsRUFBRSxDQUFDO1FBQ3ZCLGtCQUFhLEdBQVEsRUFBRSxDQUFDO1FBQ3hCLG1CQUFjLEdBQVEsRUFBRSxDQUFDO1FBQ3pCLG1CQUFjLEdBQVEsRUFBRSxD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WUFBWTtzQkFBcEIsS0FBSztnQkFDRyxhQUFhO3NCQUFyQixLQUFLO2dCQUNHLGNBQWM7c0JBQXRCLEtBQUs7Z0JBQ0csY0FBYztzQkFBdEIsS0FBSztnQkFDRyxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxJQUFJO3NCQUFaLEtBQUs7Z0JBQ0csS0FBSztzQkFBYixLQUFLO2dCQUNHLEtBQUs7c0JBQWIsS0FBSztnQkFDRyxLQUFLO3NCQUFiLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUNHLE1BQU07c0JBQWQsS0FBSztnQkFDRyxPQUFPO3NCQUFmLEtBQUs7Z0JBQ0csTUFBTTtzQkFBZCxLQUFLO2dCQUlJLE1BQU07c0JBQWYsTUFBTTtnQkFDRyxLQUFLO3NCQUFkLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkRlc3Ryb3ksIFZpZXdDaGlsZCwgRWxlbWVudFJlZiwgQWZ0ZXJWaWV3SW5pdCwgRG9DaGVjaywgT25DaGFuZ2VzLCBTaW1wbGVDaGFuZ2VzIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb21tb25Nb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgU1FMRGF0YVNlcnZpY2UgfSBmcm9tICcuLi9kYXRhLnNlcnZpY2UnO1xuaW1wb3J0IHsgTWF0Q29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvY29yZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc3FsLWZvcm0nLFxuICBzdGFuZGFsb25lOiB0cnVlLFxuICBpbXBvcnRzOiBbQ29tbW9uTW9kdWxlLCBNYXRDb21tb25Nb2R1bGVdLFxuICB0ZW1wbGF0ZVVybDogJy4vc3FsLWZvcm0uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9zcWwtZm9ybS5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgU3FsRm9ybUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgRG9DaGVjaywgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0LCBPbkRlc3Ryb3kgIHtcblxuICBsYXN0X2lkOiBhbnkgPSAnJztcbiAgbXlEYXRhT2JzITogU3Vic2NyaXB0aW9uOyAgICAgICAgLy8gZGF0YVN1YmplY3QgY29udGFpbnMgZm9ybSBmaWVsZHNcbiAgbXlDb250YWluZXJPYnMhOiBTdWJzY3JpcHRpb247ICAgLy8gY29udGFpbmVyU3ViamVjdCBjb250YWlucyBwYXJhbWV0ZXJzIG1vZGlmaWVkIGJ5IGl0cyBjb250YWluZXIuXG4gIGNvbnRhaW5lclBhcmFtZXRlcnM6IGFueSA9IHsgaWQ6ICcnLCBpZDI6ICcnLCBpZDM6ICcnIH07XG5cbiAgLy8tLSBJbnB1dHNcbiAgQElucHV0KCkgZGF0YTogYW55OyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgQElucHV0KCkgaWQ6IGFueSA9ICcwJzsgICAgICAgICBcbiAgQElucHV0KCkgaWQyOiBhbnkgPSAnMCc7ICAgICAgICAgXG4gIEBJbnB1dCgpIGlkMzogYW55ID0gJzAnO1xuICBASW5wdXQoKSBpZDJfY29sOiBhbnkgPSAnJztcbiAgQElucHV0KCkgaWQzX2NvbDogYW55ID0gJyc7XG4gIEBJbnB1dCgpIGRlZmF1bHRfY29sOiBhbnkgPSAnJzsgIFxuICBASW5wdXQoKSBkZWZhdWx0X2NvbDI6IGFueSA9ICcnOyAgXG4gIEBJbnB1dCgpIGRlZmF1bHRfY29sMzogYW55ID0gJyc7ICAgXG4gIEBJbnB1dCgpIGRlZmF1bHRfdmFsdWU6IGFueSA9ICcnOyAgXG4gIEBJbnB1dCgpIGRlZmF1bHRfdmFsdWUyOiBhbnkgPSAnJztcbiAgQElucHV0KCkgZGVmYXVsdF92YWx1ZTM6IGFueSA9ICcnO1xuICBASW5wdXQoKSB0YWJsZTogYW55ID0gXCJkdWFsXCI7XG4gIEBJbnB1dCgpIGVtYmVkZGVkOiBhbnkgPSBcIllcIjtcbiAgQElucHV0KCkgY2FyZDogYW55ID0gXCJZXCI7XG4gIEBJbnB1dCgpIGNsb3NhYmxlOiBhbnkgPSBcIk5cIjsgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgQElucHV0KCkgb3BlbjogYW55ID0gXCJZXCI7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICBASW5wdXQoKSBjbGFzczogYW55ID0gXCJcIjsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgQElucHV0KCkgc3R5bGU6IGFueSA9IFwiXCI7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gIEBJbnB1dCgpIHRpdGxlOiBhbnkgPSBcIlwiOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICBASW5wdXQoKSBic19yb3c6IGFueSA9ICdOJzsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICBASW5wdXQoKSBic19jb2w6IGFueSA9ICcnOyAgIFxuICBASW5wdXQoKSBoYW5kbGVyOiBhbnkgPSAnZGVmYXVsdCc7ICAgICAgICBcbiAgQElucHV0KCkgcmVsb2FkOiBhbnkgPSAnTic7ICAgICAgICAgICAgICBcblxuICBwYXJhbWV0ZXJzOiBhbnkgPSB7IHBhZ2U6ICcnLCBpZDogJycsIGlkMjogJycsIGlkMzogJyd9O1xuXG4gIEBPdXRwdXQoKSBjaGFuZ2U6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIEBPdXRwdXQoKSBzYXZlZDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgY291bnRlcjogbnVtYmVyID0gMDtcblxuICBzaG93RXJyb3JBbGVydDogYW55ID0gJ04nO1xuICBlcnJvck1lc3NhZ2U6IGFueSA9ICdQb3N0IEZhaWxlZCdcbiAgc2hvd1N1Y2Nlc3NBbGVydDogYW55ID0gJ04nO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX2RhdGFTZXJ2aWNlOiBTUUxEYXRhU2VydmljZSkge1xuICAgIC8vIHBhcnQgb2YgYW4gZWRpdCB0YWJsZSBvciBjb250YWluZXIuXG5cbiAgICBpZiAodGhpcy5lbWJlZGRlZD09J1knKSB7XG4gICAgICBjb25zb2xlLmxvZygnZm9ybSBjb25zdHJ1Y3RvcicpXG4gICAgICB0aGlzLm15Q29udGFpbmVyT2JzID0gdGhpcy5fZGF0YVNlcnZpY2UuY29udGFpbmVyU3ViamVjdC5zdWJzY3JpYmUoZCA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdjb250YWluZXIgcGFyYW1ldGVycycpXG4gICAgICAgIGNvbnNvbGUubG9nKGQpXG4gICAgICAgIHRoaXMuY29udGFpbmVyUGFyYW1ldGVycz1kO1xuICAgICAgICBpZiAodGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmlkIT10aGlzLmxhc3RfaWQpIHtcbiAgICAgICAgICB0aGlzLmxhc3RfaWQ9dGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmlkO1xuICAgICAgICAgIHRoaXMuaWQ9dGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmlkO1xuICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lclBhcmFtZXRlcnMuaWQyIT09dW5kZWZpbmVkKSB7IHRoaXMuaWQyPXRoaXMuY29udGFpbmVyUGFyYW1ldGVycy5pZDI7IH1cbiAgICAgICAgICBpZiAodGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmlkMyE9PXVuZGVmaW5lZCkgeyB0aGlzLmlkMz10aGlzLmNvbnRhaW5lclBhcmFtZXRlcnMuaWQzOyB9XG4gICAgICAgICAgaWYgKHRoaXMuY29udGFpbmVyUGFyYW1ldGVycy5kZWZhdWx0X2NvbCE9PXVuZGVmaW5lZCkgeyB0aGlzLmRlZmF1bHRfY29sPXRoaXMuY29udGFpbmVyUGFyYW1ldGVycy5kZWZhdWx0X2NvbDsgfVxuICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lclBhcmFtZXRlcnMuZGVmYXVsdF9jb2wyIT09dW5kZWZpbmVkKSB7IHRoaXMuZGVmYXVsdF9jb2w9dGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmRlZmF1bHRfY29sMjsgfVxuICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lclBhcmFtZXRlcnMuZGVmYXVsdF9jb2wzIT09dW5kZWZpbmVkKSB7IHRoaXMuZGVmYXVsdF9jb2w9dGhpcy5jb250YWluZXJQYXJhbWV0ZXJzLmRlZmF1bHRfY29sMzsgfVxuICAgICAgICAgIHRoaXMuZ2V0Rm9ybURhdGEoKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuXG4gICAgfSAgICAgXG4gICAgdGhpcy5teURhdGFPYnMgPSB0aGlzLl9kYXRhU2VydmljZS5kYXRhU3ViamVjdC5zdWJzY3JpYmUoZCA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdkYXRhIHN1YmplY3QnKVxuICAgICAgICB0aGlzLmRhdGE9ZDtcbiAgICAgICAgaWYgKHRoaXMuZGF0YS5pZCE9dGhpcy5sYXN0X2lkKSB7XG4gICAgICAgICAgdGhpcy5sYXN0X2lkPXRoaXMuZGF0YS5pZDtcbiAgICAgICAgICB0aGlzLmlkPXRoaXMuZGF0YS5pZDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kYXRhLnN1Ym1pdD09PSdZJykge1xuICAgICAgICAgIHRoaXMucG9zdFNRTCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmRhdGEuc3VibWl0PT09J0QnKSB7XG4gICAgICAgICAgdGhpcy5wb3N0RGVsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgIH1cblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcblxuICB9XG5cbiAgZ2V0Rm9ybURhdGEoKSB7XG4gICAgdGhpcy5wYXJhbWV0ZXJzLmlkPXRoaXMuaWQ7XG4gICAgdGhpcy5wYXJhbWV0ZXJzLmlkMj10aGlzLmlkMjtcbiAgICB0aGlzLnBhcmFtZXRlcnMuaWQzPXRoaXMuaWQzO1xuICAgIHRoaXMucGFyYW1ldGVycy5kZWZhdWx0X2NvbD10aGlzLmRlZmF1bHRfY29sO1xuICAgIHRoaXMucGFyYW1ldGVycy5kZWZhdWx0X2NvbDI9dGhpcy5kZWZhdWx0X2NvbDI7XG4gICAgdGhpcy5wYXJhbWV0ZXJzLmRlZmF1bHRfY29sMz10aGlzLmRlZmF1bHRfY29sMztcbiAgICBpZiAodGhpcy50YWJsZSE9J2R1YWwnKSB7XG4gICAgICB0aGlzLl9kYXRhU2VydmljZS5nZXRGb3JtKHRoaXMudGFibGUsIHRoaXMucGFyYW1ldGVycykuc3Vic2NyaWJlKChkYXRhOmFueSk9PntcbiAgICAgICAgICB0aGlzLmRhdGE9ZGF0YTtcbi8vICAgICAgICAgIGlmICh0aGlzLmRlZmF1bHRfY29sIT0nJykgeyB0aGlzLmRhdGFbdGhpcy5kZWZhdWx0X2NvbF09dGhpcy5kZWZhdWx0X3ZhbHVlIH1cbi8vICAgICAgICAgIGlmICh0aGlzLmRlZmF1bHRfY29sMiE9JycpIHsgdGhpcy5kYXRhW3RoaXMuZGVmYXVsdF9jb2wyXT10aGlzLmRlZmF1bHRfdmFsdWUyIH0gICAgICAgIFxuLy8gICAgICAgICAgaWYgKHRoaXMuZGVmYXVsdF9jb2wzIT0nJykgeyB0aGlzLmRhdGFbdGhpcy5kZWZhdWx0X2NvbDNdPXRoaXMuZGVmYXVsdF92YWx1ZTMgfVxuICAgICAgICAgIHRoaXMuX2RhdGFTZXJ2aWNlLnB1c2hOb3RpZmljYXRpb24odGhpcy5kYXRhKTtcbiAgICB9KTtcbiAgfVxuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuICAgICAgY29uc29sZS5sb2coJ0FWSSBnZXRpbmcgZm9ybScpXG4gICAgICBpZiAodGhpcy5lbWJlZGRlZCE9PSdZJykge1xuICAgICAgICB0aGlzLmdldEZvcm1EYXRhKCk7XG4gICAgICB9XG4gIH1cblxuICBwb3N0U1FMKCkge1xuICAgIHRoaXMuX2RhdGFTZXJ2aWNlLnBvc3RTUUwodGhpcy5kYXRhKS5zdWJzY3JpYmUoKGRhdGE6YW55KT0+e1xuICAgICAgaWYgKGRhdGEuZXJyb3JfY29kZT09XCIwXCIpIHsgXG4gICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3NBbGVydD0nWSc7XG4gICAgICAgIHRoaXMuc2hvd0Vycm9yQWxlcnQ9J04nO1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZT0nUmVjb3JkIFNhdmVkJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3NBbGVydD0nTic7XG4gICAgICAgIHRoaXMuc2hvd0Vycm9yQWxlcnQ9J1knO1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZT1kYXRhLmVycm9yX21lc3NhZ2U7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlPSdSZWNvcmQgU2F2ZWQnO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAodGhpcy5yZWxvYWQ9PSdOJykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpPT57XG4gICAgICAgICAgdGhpcy5zaG93RXJyb3JBbGVydD0nTic7XG4gICAgICAgICAgdGhpcy5zaG93U3VjY2Vzc0FsZXJ0PSdOJztcbiAgICAgICAgICB0aGlzLmRhdGEucmVmcmVzaD0nWSc7XG4gICAgICAgICAgdGhpcy5kYXRhLnN1Ym1pdD0nTic7XG4gICAgICAgICAgdGhpcy5fZGF0YVNlcnZpY2UucHVzaE5vdGlmaWNhdGlvbihkYXRhKTtcbiAgICAgICAgfSwxMDAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgICB0aGlzLnNob3dFcnJvckFsZXJ0PSdOJztcbiAgICAgICAgICB0aGlzLnNob3dTdWNjZXNzQWxlcnQ9J04nO1xuICAgICAgICAgIHRoaXMuZGF0YS5yZWZyZXNoPSdZJztcbiAgICAgICAgICB0aGlzLmRhdGEuc3VibWl0PSdOJztcbiAgICAgICAgICB0aGlzLl9kYXRhU2VydmljZS5wdXNoTm90aWZpY2F0aW9uKGRhdGEpO1xuICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9LDUwMCk7XG4gICAgICB9XG5cblxuICAgIH0pO1xuXG4gIH1cbiAgXG4gIHBvc3REZWxldGUoKSB7XG4gICAgdGhpcy5fZGF0YVNlcnZpY2UucG9zdERlbGV0ZSh0aGlzLmRhdGEpLnN1YnNjcmliZSgoZGF0YTphbnkpPT57XG4gICAgICBpZiAoZGF0YS5lcnJvcl9jb2RlPT1cIjBcIikgeyBcbiAgICAgICAgdGhpcy5zaG93U3VjY2Vzc0FsZXJ0PSdZJztcbiAgICAgICAgdGhpcy5zaG93RXJyb3JBbGVydD0nTic7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlPSdSZWNvcmQgU2F2ZWQnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zaG93U3VjY2Vzc0FsZXJ0PSdOJztcbiAgICAgICAgdGhpcy5zaG93RXJyb3JBbGVydD0nWSc7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlPWRhdGEuZXJyb3JfbWVzc2FnZTtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2U9J1JlY29yZCBTYXZlZCc7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgdGhpcy5zaG93RXJyb3JBbGVydD0nTic7XG4gICAgICAgIHRoaXMuc2hvd1N1Y2Nlc3NBbGVydD0nTic7XG4gICAgICAgIHRoaXMuZGF0YS5yZWZyZXNoPSdZJztcbiAgICAgICAgdGhpcy5kYXRhLnN1Ym1pdD0nTic7XG4gICAgICAgIHRoaXMuX2RhdGFTZXJ2aWNlLnB1c2hOb3RpZmljYXRpb24oZGF0YSk7XG4gICAgICB9LDEwMDApO1xuXG4gICAgfSk7XG5cbiAgfVxuXG4gIG5nRG9DaGVjaygpOiB2b2lkIHtcblxuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcyk6IHZvaWQge1xuXG4gIH1cblxuXG4gIG5nT25EZXN0cm95KCk6IHZvaWQge1xuLy8gICAgdGhpcy5teUNvbnRhaW5lck9icy51bnN1YnNjcmliZSgpO1xuLy8gICAgdGhpcy5teURhdGFPYnMudW5zdWJzY3JpYmUoKTtcbiAgfVxufSIsIjxkaXYgKm5nSWY9XCJjYXJkPT0nTidcIj5cbiAgICA8ZGl2ICpuZ0lmPVwiYnNfcm93PT0nWSdcIiBjbGFzcz1cInJvd1wiPlxuICAgICAgICA8ZGl2IFtjbGFzc109XCJic19jb2xcIj5cbiAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjb250ZW50VG1wbFwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2ICpuZ0lmPVwiYnNfcm93IT0nWScmJmJzX2NvbCE9JydcIj5cbiAgICAgICAgPGRpdiBbY2xhc3NdPVwiYnNfY29sXCI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY29udGVudFRtcGxcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiAqbmdJZj1cImJzX3JvdyE9J1knJiZic19jb2w9PScnXCI+XG4gICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY29udGVudFRtcGxcIj48L25nLWNvbnRhaW5lcj5cbiAgICA8L2Rpdj5cbjwvZGl2PlxuXG48ZGl2ICpuZ0lmPVwiY2FyZD09J1knXCI+XG4gICAgPGRpdiAqbmdJZj1cImJzX3Jvdz09J1knXCIgY2xhc3M9XCJyb3dcIj5cbiAgICAgICAgPGRpdiBbY2xhc3NdPVwiYnNfY29sXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLWhlYWRlclwiIHN0eWxlPVwibWFyZ2luLXRvcDogMHB4O1wiPlxuICAgICAgICAgICAgICAgICAgICA8aDI+e3sgdGl0bGUgfX08L2gyPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLWJvZHlcIj5cbiAgICAgICAgICAgICAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImNvbnRlbnRUbXBsXCI+PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGRpdiAqbmdJZj1cImJzX3JvdyE9J1knJiZic19jb2whPScnXCI+XG4gICAgICAgIDxkaXYgW2NsYXNzXT1cImJzX2NvbFwiPlxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1oZWFkZXIgcC0yXCI+XG4gICAgICAgICAgICAgICAgICAgIDxoMj57eyB0aXRsZSB9fTwvaDI+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtYm9keVwiPlxuICAgICAgICAgICAgICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiY29udGVudFRtcGxcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICA8L2Rpdj4gICAgXG4gICAgPGRpdiAqbmdJZj1cImJzX3JvdyE9J1knJiZic19jb2w9PScnXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZFwiPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLWhlYWRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8aDIgcC0yPnt7IHRpdGxlIH19PC9oMj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1ib2R5XCI+XG4gICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJjb250ZW50VG1wbFwiPjwvbmctY29udGFpbmVyPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgPC9kaXY+ICAgIFxuPC9kaXY+XG5cbjxuZy10ZW1wbGF0ZSAjY29udGVudFRtcGw+XG4gICAgPGRpdiAqbmdJZj1cInNob3dTdWNjZXNzQWxlcnQ9PSdZJ1wiIGNsYXNzPVwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiIHJvbGU9XCJhbGVydFwiPlxuICAgICAgICB7eyB0aGlzLmVycm9yTWVzc2FnZSB9fVxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2ICpuZ0lmPVwic2hvd0Vycm9yQWxlcnQ9PSdZJ1wiIGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgIHt7IHRoaXMuZXJyb3JNZXNzYWdlIH19XG4gICAgICA8L2Rpdj5cbiAgICA8bmctY29udGVudD48L25nLWNvbnRlbnQ+XG4gICAgPGRpdiAqbmdJZj1cInNob3dTdWNjZXNzQWxlcnQ9PSdZJ1wiIGNsYXNzPVwiYWxlcnQgYWxlcnQtc3VjY2Vzc1wiIHJvbGU9XCJhbGVydFwiPlxuICAgICAgICB7eyB0aGlzLmVycm9yTWVzc2FnZSB9fVxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2ICpuZ0lmPVwic2hvd0Vycm9yQWxlcnQ9PSdZJ1wiIGNsYXNzPVwiYWxlcnQgYWxlcnQtZGFuZ2VyXCIgcm9sZT1cImFsZXJ0XCI+XG4gICAgICAgIHt7IHRoaXMuZXJyb3JNZXNzYWdlIH19XG4gICAgICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+Il19